#set the environment variable to conda library folder to prevent libhdf5 not being found by snakemake
LD_LIBRARY_PATH = "$CONDA_PREFIX/lib"
shell.prefix("""
set -euo pipefail;
export LD_LIBRARY_PATH=\"{LD_LIBRARY_PATH}\";
""".format(LD_LIBRARY_PATH=LD_LIBRARY_PATH))

configfile: "config/config.yaml"

ruleorder: orthanq_candidates > mason > orthanq_preprocess

if config["simulation"]:

    include: "rules/common.smk"
    include: "rules/candidate-and-sequence-generation.smk"
    include: "rules/simulation.smk"
    include: "rules/quantification-orthanq.smk"
    include: "rules/evaluation.smk"
    include: "rules/vega.smk"

    rule all:
        input:
            # expand("results/simulation_input/SimulatedSample{num}.csv", num=num_list),
            aggregate_input_get_fractions,
            get_results,
            "results/evaluation/scatter_plot.svg",
            "results/evaluation/validation.tsv"
#todo: implement the other case
