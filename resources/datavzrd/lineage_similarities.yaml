__use_yte__: true
name: Lineage similarities
default-view: similarities
datasets:
  similarities:
    path: ?input.table
    offer-excel: true
views:
  similarities:
    dataset: similarities
    desc: |
      ### Similarity of lineages
      Pairwise differences of samples in terms of variants they contain. Every sample contains three virus variants and there are three combinations for each sample. The size and color represent the number of genomic differences. Column names starting with 'Diff_x' indicate the number of genomic variant differences between each pair of virus variants. Column names starting with 'Shared_x' indicate the number of shared genomic variants between each pair of virus variants. Tooltips appear when hovering over the bubbles, showing the names of the virus variant pair and the numerical values from the corresponding column.
    page-size: 25
    render-table:
      columns:
        regex('Lineage_Pair_.+'):
          display-mode: hidden
        Diff_1:
          custom-plot:
            data: |
              function(value, row) {
                return [{"diff": value, "lineage_pair": row["Lineage_Pair_1"]}]
              }
            spec: |
              {
                "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
                "description": "",
                "data": { "values": []},
                "mark": "circle",
                "encoding": {
                  "size": {
                    "field": "diff",
                    "type": "quantitative",
                    "scale": {"domain": [0, 125]},
                    "legend": null
                  },
                  "color":{
                    "field": "diff",
                    "type": "quantitative",
                    "scale": {
                      "domain": [0, 125],
                      "scheme": "inferno"
                    },
                    "legend": null
                  },
                  "tooltip": [
                    {"field": "lineage_pair", "title": "Lineages", "type": "nominal"},
                    {
                      "field": "diff",
                      "title": "Differences",
                      "type": "quantitative"
                    }
                  ]
                }
              }
        Diff_2:
          custom-plot:
            data: |
              function(value, row) {
                return [{"diff": value, "lineage_pair": row["Lineage_Pair_2"]}]
              }
            spec: |
              {
                "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
                "description": "",
                "data": { "values": []},
                "mark": "circle",
                "encoding": {
                  "size": {
                    "field": "diff",
                    "type": "quantitative",
                    "scale": {"domain": [0, 125]},
                    "legend": null
                  },
                  "color":{
                    "field": "diff",
                    "type": "quantitative",
                    "scale": {
                      "domain": [0, 125],
                      "scheme": "inferno"
                    },
                    "legend": null
                  },
                  "tooltip": [
                    {"field": "lineage_pair", "title": "Lineages", "type": "nominal"},
                    {
                      "field": "diff",
                      "title": "Differences",
                      "type": "quantitative"
                    }
                  ]
                }
              }
        Diff_3:
          custom-plot:
            data: |
              function(value, row) {
                return [{"diff": value, "lineage_pair": row["Lineage_Pair_3"]}]
              }
            spec: |
              {
                "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
                "description": "",
                "data": { "values": []},
                "mark": "circle",
                "encoding": {
                  "size": {
                    "field": "diff",
                    "type": "quantitative",
                    "scale": {"domain": [0, 125]},
                    "legend": null
                  },
                  "color":{
                    "field": "diff",
                    "type": "quantitative",
                    "scale": {
                      "domain": [0, 125],
                      "scheme": "inferno"
                    },
                    "legend": null
                  },
                  "tooltip": [
                    {"field": "lineage_pair", "title": "Lineages", "type": "nominal"},
                    {
                      "field": "diff",
                      "title": "Differences",
                      "type": "quantitative"
                    }
                  ]
                }
              }
        Shared_1:
          custom-plot:
            data: |
              function(value, row) {
                return [{"shared": value, "lineage_pair": row["Lineage_Pair_1"]}]
              }
            spec: |
              {
                "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
                "description": "",
                "data": { "values": []},
                "mark": "circle",
                "encoding": {
                  "size": {
                    "field": "shared",
                    "type": "quantitative",
                    "scale": {"domain": [0, 125]},
                    "legend": null
                  },
                  "color":{
                    "field": "shared",
                    "type": "quantitative",
                    "scale": {
                      "domain": [0, 125],
                      "scheme": "viridis"
                    },
                    "legend": null
                  },
                  "tooltip": [
                    {"field": "lineage_pair", "title": "Lineages", "type": "nominal"},
                    {"field": "shared", "title": "Shared", "type": "quantitative"}
                  ]
                }
              }
        Shared_2:
          custom-plot:
            data: |
              function(value, row) {
                return [{"shared": value, "lineage_pair": row["Lineage_Pair_2"]}]
              }
            spec: |
              {
                "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
                "description": "",
                "data": { "values": []},
                "mark": "circle",
                "encoding": {
                  "size": {
                    "field": "shared",
                    "type": "quantitative",
                    "scale": {"domain": [0, 125]},
                    "legend": null
                  },
                  "color":{
                    "field": "shared",
                    "type": "quantitative",
                    "scale": {
                      "domain": [0, 125],
                      "scheme": "viridis"
                    },
                    "legend": null
                  },
                  "tooltip": [
                    {"field": "lineage_pair", "title": "Lineages", "type": "nominal"},
                    {"field": "shared", "title": "Shared", "type": "quantitative"}
                  ]
                }
              }
        Shared_3:
          custom-plot:
            data: |
              function(value, row) {
                return [{"shared": value, "lineage_pair": row["Lineage_Pair_3"]}]
              }
            spec: |
              {
                "$schema": "https://vega.github.io/schema/vega-lite/v6.json",
                "description": "",
                "data": { "values": []},
                "mark": "circle",
                "encoding": {
                  "size": {
                    "field": "shared",
                    "type": "quantitative",
                    "scale": {"domain": [0, 125]},
                    "legend": null
                  },
                  "color":{
                    "field": "shared",
                    "type": "quantitative",
                    "scale": {
                      "domain": [0, 125],
                      "scheme": "viridis"
                    },
                    "legend": null
                  },
                  "tooltip": [
                    {"field": "lineage_pair", "title": "Lineages", "type": "nominal"},
                    {"field": "shared", "title": "Shared", "type": "quantitative"}
                  ]
                }
              }
